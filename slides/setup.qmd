
```{r}
#| label: setup
#| output: false

library(tidyverse)
library(tidycensus)
library(ggpattern)

ddir <- here::here("data")

nykeep <- paste0("36", c("001", "083", "091", "093", "113", "115"))
vtkeep <- "50003"
keepcos <- c(nykeep, vtkeep)

nyplaces <- c("3611825", "3630675", "3664771", "3665750") 

```


```{r}
#| label: functions
#| output: false

barline <- function(data, title, ylab, ybreaks, yint){
  data |> 
    ggplot(aes(x = reorder(NAME, estimate), y = estimate, fill = special)) +
    geom_col(width = 0.2) +
    scale_fill_manual(values = c("lightblue", "blue")) +
    geom_hline(yintercept = yint, color = "red", linetype = "solid", linewidth = .75) +
    scale_y_continuous(name=ylab, labels = scales::label_comma(),
                       breaks = ybreaks) +
    labs(title = title,
       subtitle = "2019-2023 American Community Survey",
       x = NULL) +
    theme_minimal() +
    theme(legend.position = "None")
}

```


```{r}
#| label: links
#| eval: false
#| output: false

# https://bookdown.org/yihui/rmarkdown-cookbook/reuse-chunks.html

# https://walkerke.github.io/tidycensus/articles/basic-usage.html#geography-in-tidycensus
# 
 
```



```{r}
#| eval: false
#| output: false

# B01003_001E population
# B01002_001E median age
# B19013_001E median income
# B25077_001E median home value
# B25064_001E median gross rent
# B25003_001E total housing units
# B25002_002E owner occupied housing units
# B25002_003E renter occupied housing units
# B25002_001E total occupied housing units 
# B25002_001E - B25003_001E vacant housing units
# ai did the following VERIFY
# B25002_001E / B25003_001E vacancy rate
# B25002_001E / B01003_001E housing units per person
# B25002_001E / B01002_001E housing units per person
# B25002_001E / B19013_001E housing units per dollar of income

# villages (and places)
# 3602550 Argyle village
# 3611825 Cambridge village
# 3630675 Greenwich village
# 3635474 Hoosick Falls village
# 3664771 Salem CDP
# 3665255 Saratoga Springs city
# 3665750 Schuylerville village
# 5004750 Bennington CDP

nyplaces <- c("3611825", "3630675", "3664771", "3665750") 
 
nyvtco <- get_acs(geography = "place", variables = "B01003_001E", state = c("NY", "VT"), year = 2023)

pname <- "Bennington"
nyvtco |> 
  filter(str_detect(NAME, coll(pname, ignore_case = TRUE)))
         
```

